SELECT C_CITY, S_CITY, D_YEAR, SUM(LO_REVENUE) AS REVENUE FROM CUSTOMER, LINEORDER, SUPPLIER, DATE WHERE LO_CUSTKEY = C_CUSTKEY AND LO_SUPPKEY = S_SUPPKEY AND LO_ORDERDATE = D_DATEKEY AND D_YEARMONTH = 'DEC1997' GROUP BY C_CITY, S_CITY, D_YEAR ORDER BY D_YEAR ASC, REVENUE DESC AND INTERSECTS(C_REGION, QW1) AND AND INTERSECTS(S_REGION, QW1)AND INTERSECTS(C_NATION, QW2) AND INTERSECTS(S_NATION, QW2)AND INTERSECTS(C_CITY, QW3) AND INTERSECTS(S_CITY, QW3)AND INTERSECTS(C_STREET, QW4) AND INTERSECTS(S_STREET, QW4)AND INTERSECTS(C_ADDRESS, QW5) AND INTERSECTS(S_ADDRESS, QW5)AND INTERSECTS(EMPTY AREA, QW6)
