SELECT D_YEAR, S_NATION, P_CATEGORY, SUM(LO_REVENUE - LO_SUPPLYCOST) AS PROFIT FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER WHERE LO_CUSTKEY = C_CUSTKEY AND LO_SUPPKEY = S_SUPPKEY AND LO_PARTKEY = P_PARTKEY AND LO_ORDERDATE = D_DATEKEY AND (D_YEAR = 1997 OR D_YEAR = 1998) AND (P_MFGR = 'MFGR#1' OR P_MFGR = 'MFGR#2') GROUP BY D_YEAR, P_CATEGORY ORDER BY D_YEAR, P_CATEGORY AND INTERSECTS(C_REGION, QW1) AND AND INTERSECTS(S_REGION, QW1)AND INTERSECTS(C_NATION, QW2) AND INTERSECTS(S_NATION, QW2)AND INTERSECTS(C_CITY, QW3) AND INTERSECTS(S_CITY, QW3)AND INTERSECTS(C_STREET, QW4) AND INTERSECTS(S_STREET, QW4)AND INTERSECTS(C_ADDRESS, QW5) AND INTERSECTS(S_ADDRESS, QW5)AND INTERSECTS(EMPTY AREA, QW6)
